<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="4/9/2015 2:46:44 PM"
  DTS:CreationName="SSIS.Package.3"
  DTS:CreatorComputerName="SQLMDW2"
  DTS:CreatorName="OHSUM01\jamesv"
  DTS:DTSID="{D9A56EE6-739A-4C24-A03F-FAEFA93E41AD}"
  DTS:ExecutableType="SSIS.Package.3"
  DTS:LastModifiedProductVersion="11.0.3436.0"
  DTS:LocaleID="1033"
  DTS:ObjectName="2-Disable_AD_Accounts"
  DTS:PackageType="5"
  DTS:VersionBuild="49"
  DTS:VersionGUID="{6192A052-62CA-4DAB-A480-FA98FEE23E24}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">6</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[AD_Acc_Export.txt]"
      DTS:CreationName="FLATFILE"
      DTS:DTSID="{78E7174C-31F7-4961-814F-7831960D960A}"
      DTS:ObjectName="AD_Acc_Export.txt">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="FixedWidth"
          DTS:LocaleID="1033"
          DTS:Unicode="True"
          DTS:HeaderRowsToSkip="2"
          DTS:HeaderRowDelimiter="_x000D__x000A_"
          DTS:ColumnNamesInFirstDataRow="True"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x003C_none_x003E_"
          DTS:CodePage="1252"
          DTS:ConnectionString="F:\AD_Account_Stage\AD_Acc_Export.txt">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="47"
              DTS:MaximumWidth="47"
              DTS:DataType="130"
              DTS:ObjectName="Name"
              DTS:DTSID="{30379344-41AD-4ED7-B503-7AB7405615F7}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="7"
              DTS:MaximumWidth="7"
              DTS:DataType="130"
              DTS:ObjectName="Enabled"
              DTS:DTSID="{FC46A729-0E45-44C2-91BE-FFDE2E70E334}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="28"
              DTS:MaximumWidth="28"
              DTS:DataType="130"
              DTS:ObjectName="ObjectClass"
              DTS:DTSID="{5F532378-8F43-4F22-8F7A-E92F141692B1}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[AD_Disable_Acc.csv]"
      DTS:CreationName="FLATFILE"
      DTS:Description="AD_Disable_Acc.csv"
      DTS:DTSID="{01EC578E-1944-4FCE-8303-2EA5025DA709}"
      DTS:ObjectName="AD_Disable_Acc.csv">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="Delimited"
          DTS:LocaleID="1033"
          DTS:HeaderRowDelimiter="_x002C_"
          DTS:ColumnNamesInFirstDataRow="True"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x003C_none_x003E_"
          DTS:CodePage="1252"
          DTS:ConnectionString="F:\AD_Account_Stage\AD_Disable_Acc.csv">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x000D__x000A_"
              DTS:MaximumWidth="256"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="samAccountName"
              DTS:DTSID="{B1CAE7B8-FEE5-4391-8139-673726184621}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[SQLMDW2.WatchDog]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{8DE2A79F-B033-4729-9FBE-D02983DA26C2}"
      DTS:ObjectName="SQLMDW2.WatchDog">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=SQLMDW2;Initial Catalog=WatchDog;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{73DE7F98-3D14-49D5-9565-07F5F258D320}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="AccountsToDisable">
      <DTS:VariableValue
        DTS:DataType="19">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{B92F7A5B-8E39-4A99-BF9A-F4EAC2B1982B}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="BatchID">
      <DTS:VariableValue
        DTS:DataType="8">20150420162000</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4A309841-B244-433A-8EC6-7656FB54DD9B}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DeleteFileName">
      <DTS:VariableValue
        DTS:DataType="8">AD_Delete_Acc</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{2E844386-8554-4694-8C46-CC200DAC5639}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::DestPath] + @[User::DeleteFileName] + &quot;_&quot; +  @[User::FileNameDate] + &quot;.csv&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DestDeleteName">
      <DTS:VariableValue
        DTS:DataType="8">F:\AD_Account_Stage\archive\AD_Delete_Acc_20150420162000.csv</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F8848158-E6B2-4E98-AFCE-BAE92D6FE78B}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::DestPath] + @[User::DisableFileName] + &quot;_&quot; +  @[User::FileNameDate] + &quot;.csv&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DestDisableName">
      <DTS:VariableValue
        DTS:DataType="8">F:\AD_Account_Stage\archive\AD_Disable_Acc_20150420162000.csv</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F4B142B8-E40F-46CA-87A7-C9DFCBC2246C}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::DestPath] + @[User::FileName] + &quot;_&quot; +  @[User::FileNameDate] + &quot;.txt&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DestName">
      <DTS:VariableValue
        DTS:DataType="8">F:\AD_Account_Stage\archive\AD_Acc_Export_20150420162000.txt</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{AEBDE5CD-CE22-4804-8E3F-F2DFF86AE132}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DestPath">
      <DTS:VariableValue
        DTS:DataType="8">F:\AD_Account_Stage\archive\</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{79ACC440-AFFC-49CC-AF56-41E924783E8C}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DisableFileName">
      <DTS:VariableValue
        DTS:DataType="8">AD_Disable_Acc</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{2CBF32CE-7241-4794-90ED-AE5B8C2C0096}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="FileName">
      <DTS:VariableValue
        DTS:DataType="8">AD_Acc_Export</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A9AA9031-1B17-4DDE-91C5-BB90C76F67AD}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::BatchID]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="FileNameDate">
      <DTS:VariableValue
        DTS:DataType="8">20150420162000</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3DEB06D6-C8F7-489F-8C9B-15BC85F8FB51}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::SourcePath] + @[User::DisableFileName] + &quot;.csv&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SourceDisableName">
      <DTS:VariableValue
        DTS:DataType="8">F:\AD_Account_Stage\AD_Disable_Acc.csv</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D4069258-4900-42B3-8F66-44E04149F9BA}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::SourcePath] + @[User::FileName] + &quot;.txt&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SourceName">
      <DTS:VariableValue
        DTS:DataType="8">F:\AD_Account_Stage\AD_Acc_Export.txt</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A75E02A3-818B-455F-8ECA-3F73C8C94771}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SourcePath">
      <DTS:VariableValue
        DTS:DataType="8">F:\AD_Account_Stage\</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\1 update_sp_ETL_AD_Audit_Accounts_Disable"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Flag eligible disable queue accounts"
      DTS:DTSID="{4951181C-6B7D-4B33-A7CB-629D2086939E}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="1 update_sp_ETL_AD_Audit_Accounts_Disable"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8DE2A79F-B033-4729-9FBE-D02983DA26C2}"
          SQLTask:SqlStatementSource="EXEC update_sp_ETL_AD_Audit_Accounts_Disable"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="BatchID"
            SQLTask:DtsVariableName="User::BatchID" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\2 Verify # of accounts to disable"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{D7B0508D-101F-41B2-9FC6-07C2EA2D34A9}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="2 Verify # of accounts to disable"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8DE2A79F-B033-4729-9FBE-D02983DA26C2}"
          SQLTask:SqlStatementSource="SELECT CASE WHEN COUNT(*) &gt; 0 THEN 1 ELSE 0 END AS Result FROM AD_Disable_Queue&#xA;WHERE DisableFlag &lt;&gt; 1 AND DisableBatchID = ?&#xA;&#xA;----(SELECT SetVarchar FROM AD_Settings WHERE SettingName = 'DisableBatchID')"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="Result"
            SQLTask:DtsVariableName="User::AccountsToDisable" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::BatchID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\3 Export Accounts to csv"
      DTS:CreationName="SSIS.Pipeline.3"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{173787F7-4848-4AF3-A366-20F72151C940}"
      DTS:ExecutableType="SSIS.Pipeline.3"
      DTS:LocaleID="-1"
      DTS:ObjectName="3 Export Accounts to csv"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\3 Export Accounts to csv\Flat File Destination"
              componentClassID="{8DA75FED-1B7C-407D-B2AD-2B24209CCCA4}"
              contactInfo="Flat File Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
              description="Flat File Destination"
              localeId="1033"
              name="Flat File Destination">
              <properties>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether the data will overwrite or append to the destination file."
                  name="Overwrite">true</property>
                <property
                  dataType="System.Null"
                  description="Specifies the text to write to the destination file before any data is written."
                  expressionType="Notify"
                  name="Header" />
              </properties>
              <connections>
                <connection
                  refId="Package\3 Export Accounts to csv\Flat File Destination.Connections[FlatFileConnection]"
                  connectionManagerID="Package.ConnectionManagers[AD_Disable_Acc.csv]"
                  connectionManagerRefId="Package.ConnectionManagers[AD_Disable_Acc.csv]"
                  name="FlatFileConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\3 Export Accounts to csv\Flat File Destination.Inputs[Flat File Destination Input]"
                  hasSideEffects="true"
                  name="Flat File Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\3 Export Accounts to csv\Flat File Destination.Inputs[Flat File Destination Input].Columns[samAccountName]"
                      cachedDataType="wstr"
                      cachedLength="256"
                      cachedName="samAccountName"
                      externalMetadataColumnId="Package\3 Export Accounts to csv\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[samAccountName]"
                      lineageId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Output].Columns[samAccountName]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\3 Export Accounts to csv\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[samAccountName]"
                      codePage="1252"
                      dataType="str"
                      length="256"
                      name="samAccountName" />
                  </externalMetadataColumns>
                </input>
              </inputs>
            </component>
            <component
              refId="Package\3 Export Accounts to csv\OLE DB Source"
              componentClassID="{165A526D-D5DE-47FF-96A6-F8274C19826B}"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="OLE DB Source"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">DECLARE @DisableBatchID VARCHAR(14)
SET @DisableBatchID = (SELECT SetVarchar FROM AD_Settings WHERE SettingName = 'DisableBatchID')
----Distinct should not be necessary since AccoutName is a unique key, but I'm paranoid
SELECT DISTINCT CONVERT(NVARCHAR(256), ('"CN=' + a.AccountName + ',OU=SQL Service Accounts,OU=Service Accounts,OU=Special Accounts,DC=ohsum01,DC=ohsu,DC=edu"')) AS samAccountName FROM AD_Disable_Queue a
WHERE a.DisableBatchID = @DisableBatchID</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">2</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\3 Export Accounts to csv\OLE DB Source.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[SQLMDW2.WatchDog]"
                  connectionManagerRefId="Package.ConnectionManagers[SQLMDW2.WatchDog]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Output].Columns[samAccountName]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[samAccountName]"
                      length="256"
                      lineageId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Output].Columns[samAccountName]"
                      name="samAccountName"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[samAccountName]"
                      dataType="wstr"
                      length="256"
                      name="samAccountName" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[samAccountName]"
                      dataType="wstr"
                      length="256"
                      lineageId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[samAccountName]"
                      name="samAccountName" />
                    <outputColumn
                      refId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\3 Export Accounts to csv.Paths[OLE DB Source Output]"
              endId="Package\3 Export Accounts to csv\Flat File Destination.Inputs[Flat File Destination Input]"
              name="OLE DB Source Output"
              startId="Package\3 Export Accounts to csv\OLE DB Source.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\4 Disable Service Accounts via Powershell"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteProcess.ExecuteProcess, Microsoft.SqlServer.ExecProcTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute Process Task"
      DTS:DTSID="{20E8E49D-BDDD-4024-A0F9-30BB0A352766}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteProcess.ExecuteProcess, Microsoft.SqlServer.ExecProcTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="4 Disable Service Accounts via Powershell"
      DTS:TaskContact="Execute Process Task;Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExecuteProcessData
          Executable="C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe"
          Arguments="F:\AD_Account_Stage\scripts\disable_sql_service_accounts.ps1" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\5 Mark accounts as disabled"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Updates rows in Disable_Queue"
      DTS:DTSID="{B724CBC8-C6A4-4638-97D4-311CD0AA6BB2}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="5 Mark accounts as disabled"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8DE2A79F-B033-4729-9FBE-D02983DA26C2}"
          SQLTask:SqlStatementSource="DECLARE @Today DATETIME2 = GETDATE()&#xA;&#xA;UPDATE AD_Disable_Queue SET DisableFlag = 1, DisableDate = @Today&#xA;WHERE DisableBatchID = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::BatchID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\6 Copy file to archive folder &amp; append datetime"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.FileSystemTask.FileSystemTask, Microsoft.SqlServer.FileSystemTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="File System Task"
      DTS:DTSID="{22B97B69-0CB3-4C53-9665-4B392BB2130C}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.FileSystemTask.FileSystemTask, Microsoft.SqlServer.FileSystemTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="6 Copy file to archive folder &amp; append datetime"
      DTS:TaskContact="File System Task;Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <FileSystemData
          TaskSourcePath="User::SourceDisableName"
          TaskIsSourceVariable="True"
          TaskDestinationPath="User::DestDisableName"
          TaskIsDestinationVariable="True" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\7 Delete AD_Disable_Acc"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.FileSystemTask.FileSystemTask, Microsoft.SqlServer.FileSystemTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="File System Task"
      DTS:DTSID="{68BAC8F4-81EA-4AAD-9570-9B3D718FD81B}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.FileSystemTask.FileSystemTask, Microsoft.SqlServer.FileSystemTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="7 Delete AD_Disable_Acc"
      DTS:TaskContact="File System Task;Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <FileSystemData
          TaskOperationType="DeleteFile"
          TaskSourcePath="User::SourceDisableName"
          TaskIsSourceVariable="True" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\8 Log Job Completion"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{74306657-7929-4720-9E47-9C2B5A2B99C9}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="8 Log Job Completion"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8DE2A79F-B033-4729-9FBE-D02983DA26C2}"
          SQLTask:SqlStatementSource="INSERT INTO DBA_Rep.dbo.SSIS_Job_History&#xA;( machinename&#xA;, packagename&#xA;, username&#xA;, packagestartdate&#xA;, retrievedate&#xA;)&#xA;VALUES&#xA;( ? ,&#xA;? ,&#xA;? ,&#xA;GETDATE() ,&#xA;GETDATE()&#xA;)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="System::MachineName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="System::PackageName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="System::UserName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{D3068021-8E41-46F6-8615-249248906EF5}"
      DTS:From="Package\1 update_sp_ETL_AD_Audit_Accounts_Disable"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\2 Verify # of accounts to disable" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{6D7E35C3-4D05-4CC6-A329-55379C473A7A}"
      DTS:EvalOp="1"
      DTS:Expression="@[User::AccountsToDisable] == 1"
      DTS:From="Package\2 Verify # of accounts to disable"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\3 Export Accounts to csv" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 10]"
      DTS:CreationName=""
      DTS:DTSID="{C8D4919C-0E29-4B5A-8E01-02EEDC65E036}"
      DTS:From="Package\5 Mark accounts as disabled"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 10"
      DTS:To="Package\6 Copy file to archive folder &amp; append datetime" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{6BB73552-04AD-437D-A596-EDADF1880AED}"
      DTS:From="Package\3 Export Accounts to csv"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\4 Disable Service Accounts via Powershell" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{E593D275-BCFB-4505-879B-DFF34C30B691}"
      DTS:From="Package\7 Delete AD_Disable_Acc"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\8 Log Job Completion" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{FCE20B8E-D92C-4589-AAE1-58AD2B10BF30}"
      DTS:From="Package\6 Copy file to archive folder &amp; append datetime"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\7 Delete AD_Disable_Acc" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 9]"
      DTS:CreationName=""
      DTS:DTSID="{C5EA76AF-04DE-4ED7-BCBF-96B88BA3A248}"
      DTS:From="Package\4 Disable Service Accounts via Powershell"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 9"
      DTS:To="Package\5 Mark accounts as disabled" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="sql11">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="300,42"
          Id="Package\1 update_sp_ETL_AD_Audit_Accounts_Disable"
          TopLeft="45,34" />
        <NodeLayout
          Size="234,42"
          Id="Package\2 Verify # of accounts to disable"
          TopLeft="78,116" />
        <NodeLayout
          Size="197,42"
          Id="Package\3 Export Accounts to csv"
          TopLeft="380,117" />
        <NodeLayout
          Size="277,42"
          Id="Package\4 Disable Service Accounts via Powershell"
          TopLeft="291,192" />
        <NodeLayout
          Size="213,42"
          Id="Package\5 Mark accounts as disabled"
          TopLeft="604,194" />
        <NodeLayout
          Size="304,42"
          Id="Package\6 Copy file to archive folder &amp; append datetime"
          TopLeft="453,264" />
        <NodeLayout
          Size="199,42"
          Id="Package\7 Delete AD_Disable_Acc"
          TopLeft="810,263" />
        <NodeLayout
          Size="183,42"
          Id="Package\8 Log Job Completion"
          TopLeft="820,333" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="195,76">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,40"
              Start="0,0"
              End="0,32.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,32.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="312,137.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="68,0"
              Start="0,0"
              End="60.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="60.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="22.25,5,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 10]"
          TopLeft="710.5,236">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-105.5,28"
              Start="0,0"
              End="-105.5,20.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,10" />
                  <mssgle:CubicBezierSegment
                    Point1="0,10"
                    Point2="0,14"
                    Point3="-4,14" />
                  <mssgle:LineSegment
                    End="-101.5,14" />
                  <mssgle:CubicBezierSegment
                    Point1="-101.5,14"
                    Point2="-105.5,14"
                    Point3="-105.5,18" />
                  <mssgle:LineSegment
                    End="-105.5,20.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="478.5,159">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-49,33"
              Start="0,0"
              End="-49,25.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,12.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,12.5"
                    Point2="0,16.5"
                    Point3="-4,16.5" />
                  <mssgle:LineSegment
                    End="-45,16.5" />
                  <mssgle:CubicBezierSegment
                    Point1="-45,16.5"
                    Point2="-49,16.5"
                    Point3="-49,20.5" />
                  <mssgle:LineSegment
                    End="-49,25.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="910.5,305">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,28"
              Start="0,0"
              End="0,20.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,20.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="757,284.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="53,0"
              Start="0,0"
              End="45.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="45.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 9]"
          TopLeft="568,214">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="36,0"
              Start="0,0"
              End="28.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="28.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <AnnotationLayout
          Text="Created by Vince James on 20150417"
          ParentId="Package"
          FontInfo="{assembly:Null}"
          Size="214,39"
          Id="367b43d5-9d38-4ce4-814c-f32c53aa1bac"
          TopLeft="717,20" />
        <AnnotationLayout
          Text="fx = # of accounts must be greater than 0"
          ParentId="Package"
          FontInfo="{assembly:Null}"
          Size="238,39"
          Id="2b96c6ac-d8d5-4357-afc0-7f79cc057f42"
          TopLeft="303,82" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\3 Export Accounts to csv">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="152,42"
          Id="Package\3 Export Accounts to csv\OLE DB Source"
          TopLeft="138,117" />
        <NodeLayout
          Size="174,42"
          Id="Package\3 Export Accounts to csv\Flat File Destination"
          TopLeft="127,235" />
        <EdgeLayout
          Id="Package\3 Export Accounts to csv.Paths[OLE DB Source Output]"
          TopLeft="214,159">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,76"
              Start="0,0"
              End="0,68.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,68.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\3 Export Accounts to csv\OLE DB Source">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>